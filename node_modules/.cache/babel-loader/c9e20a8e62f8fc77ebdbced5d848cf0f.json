{"ast":null,"code":"import _regeneratorRuntime from\"/Users/liwentian/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/liwentian/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/liwentian/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _readOnlyError from\"/Users/liwentian/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/readOnlyError\";import PlaceList from'../components/PlaceList';import React,{useEffect,useState}from'react';import{useHttpClient}from'../../shared/hooks/http-hook';import LoadingSpinner from'../../shared/components/UIElements/LoadingSpinner';import PaginationPage from'../../shared/components/UIElements/pagination';var UserPlaces=function UserPlaces(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),LoadedTheatres=_useState2[0],setLoadedTheatres=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setisLoading=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),currentPage=_useState8[0],setcurrentPage=_useState8[1];var postsPerPage=20;var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),currentPosts=_useState10[0],setcurrentPosts=_useState10[1];useEffect(function(){var fetchTheatres=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,responseData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setisLoading(true);_context.prev=1;_context.next=4;return fetch(process.env.REACT_APP_BACKEND_URL+\"/theatres\");case 4:response=_context.sent;_context.next=7;return response.json();case 7:responseData=_context.sent;if(response.ok){_context.next=10;break;}throw new Error(responseData.message);case 10:setLoadedTheatres(responseData.cinemas);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);setError(_context.t0.message);case 16:setisLoading(false);case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,13]]);}));return function fetchTheatres(){return _ref.apply(this,arguments);};}();fetchTheatres();},[]);var indexOfLastPosts=currentPage*postsPerPage;var indexOfFirstPost=indexOfLastPosts-postsPerPage;var paginate=function paginate(pageNumber){return setcurrentPage(pageNumber);};useEffect(function(){var updatePosts=function updatePosts(){setcurrentPosts(LoadedTheatres.slice(indexOfFirstPost,indexOfLastPosts));};updatePosts();},[LoadedTheatres,currentPage,PaginationPage]);var errorHandler=function errorHandler(){setError=(_readOnlyError(\"setError\"),null);};return React.createElement(React.Fragment,null,React.createElement(PaginationPage,{postsPerPage:postsPerPage,totalPosts:LoadedTheatres.length,paginate:paginate}),isLoading&&React.createElement(\"div\",null,React.createElement(LoadingSpinner,null)),!isLoading&&LoadedTheatres&&React.createElement(PlaceList,{items:currentPosts}));};export default UserPlaces;","map":{"version":3,"sources":["/Users/liwentian/Desktop/frontend/src/places/pages/UserPlaces.js"],"names":["PlaceList","React","useEffect","useState","useHttpClient","LoadingSpinner","PaginationPage","UserPlaces","LoadedTheatres","setLoadedTheatres","isLoading","setisLoading","error","setError","currentPage","setcurrentPage","postsPerPage","currentPosts","setcurrentPosts","fetchTheatres","fetch","process","env","REACT_APP_BACKEND_URL","response","json","responseData","ok","Error","message","cinemas","indexOfLastPosts","indexOfFirstPost","paginate","pageNumber","updatePosts","slice","errorHandler","length"],"mappings":"6lBAAA,MAAOA,CAAAA,SAAP,KAAsB,yBAAtB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,CAA0BC,QAA1B,KAA0C,OAA1C,CAEA,OAASC,aAAT,KAA8B,8BAA9B,CACA,MAAOC,CAAAA,cAAP,KAA2B,mDAA3B,CACA,MAAOC,CAAAA,cAAP,KAA2B,+CAA3B,CACA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,eACmBJ,QAAQ,CAAC,EAAD,CAD3B,wCACjBK,cADiB,eACFC,iBADE,8BAESN,QAAQ,CAAC,KAAD,CAFjB,yCAEjBO,SAFiB,eAEPC,YAFO,8BAGCR,QAAQ,EAHT,yCAGjBS,KAHiB,eAGXC,QAHW,8BAIaV,QAAQ,CAAC,CAAD,CAJrB,yCAIjBW,WAJiB,eAILC,cAJK,eAKvB,GAAMC,CAAAA,YAAY,CAAG,EAArB,CALuB,eAMgBb,QAAQ,CAAC,EAAD,CANxB,0CAMhBc,YANgB,gBAMHC,eANG,gBAQvBhB,SAAS,CAAC,UAAI,CAEZ,GAAMiB,CAAAA,aAAa,0FAAG,6JACpBR,YAAY,CAAC,IAAD,CAAZ,CADoB,sCAGIS,CAAAA,KAAK,CAACC,OAAO,CAACC,GAAR,CAAYC,qBAAZ,YAAD,CAHT,QAGZC,QAHY,qCAISA,CAAAA,QAAQ,CAACC,IAAT,EAJT,QAIZC,YAJY,kBAKdF,QAAQ,CAACG,EALK,+BAOV,IAAIC,CAAAA,KAAJ,CAAUF,YAAY,CAACG,OAAvB,CAPU,SASlBpB,iBAAiB,CAACiB,YAAY,CAACI,OAAd,CAAjB,CATkB,iFAWlBjB,QAAQ,CAAC,YAAIgB,OAAL,CAAR,CAXkB,QAapBlB,YAAY,CAAC,KAAD,CAAZ,CAboB,qEAAH,kBAAbQ,CAAAA,aAAa,0CAAnB,CAgBAA,aAAa,GACd,CAnBQ,CAmBP,EAnBO,CAAT,CAqBA,GAAMY,CAAAA,gBAAgB,CAAGjB,WAAW,CAAGE,YAAvC,CACC,GAAMgB,CAAAA,gBAAgB,CAAGD,gBAAgB,CAAGf,YAA5C,CACA,GAAMiB,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAAC,UAAU,QAAInB,CAAAA,cAAc,CAACmB,UAAD,CAAlB,EAA3B,CAEDhC,SAAS,CAAC,UAAI,CACZ,GAAMiC,CAAAA,WAAW,CAAC,QAAZA,CAAAA,WAAY,EAAI,CACtBjB,eAAe,CAACV,cAAc,CAAC4B,KAAf,CAAqBJ,gBAArB,CAAsCD,gBAAtC,CAAD,CAAf,CAAyE,CADzE,CAEAI,WAAW,GAAG,CAHP,CAGQ,CAAC3B,cAAD,CAAgBM,WAAhB,CAA4BR,cAA5B,CAHR,CAAT,CAKA,GAAM+B,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAK,CACxBxB,QAAQ,6BAAE,IAAF,CAAR,CACD,CAFD,CAMA,MACE,qBAAC,KAAD,CAAO,QAAP,MACA,oBAAC,cAAD,EAAgB,YAAY,CAAEG,YAA9B,CAA4C,UAAU,CAAER,cAAc,CAAC8B,MAAvE,CAA+E,QAAQ,CAAEL,QAAzF,EADA,CAECvB,SAAS,EAAK,+BAAK,oBAAC,cAAD,MAAL,CAFf,CAGC,CAACA,SAAD,EAAcF,cAAd,EAAgC,oBAAC,SAAD,EAAW,KAAK,CAAES,YAAlB,EAHjC,CADF,CAMC,CAlDH,CAoDA,cAAeV,CAAAA,UAAf","sourcesContent":["import PlaceList from '../components/PlaceList';\nimport React, { useEffect,useState } from 'react';\n\nimport { useHttpClient } from '../../shared/hooks/http-hook';\nimport LoadingSpinner from '../../shared/components/UIElements/LoadingSpinner';\nimport PaginationPage from '../../shared/components/UIElements/pagination';\nconst UserPlaces = () => {\n  const[LoadedTheatres,setLoadedTheatres] = useState([]);\n  const[isLoading,setisLoading] = useState(false);\n  const[error,setError] = useState();\n  const[currentPage,setcurrentPage] = useState(1);\n  const postsPerPage = 20;\n  const [currentPosts,setcurrentPosts] = useState([]);\n  \n  useEffect(()=>{\n\n    const fetchTheatres = async()=>{\n      setisLoading(true);\n      try{          \n        const response= await fetch(process.env.REACT_APP_BACKEND_URL+`/theatres`); \n        const responseData = await response.json();\n        if(!response.ok){\n    \n          throw new Error(responseData.message);\n        }\n        setLoadedTheatres(responseData.cinemas);\n      } catch (err) {\n        setError(err.message);\n      }\n      setisLoading(false);\n    };\n\n    fetchTheatres();\n  },[]);\n\n  const indexOfLastPosts = currentPage * postsPerPage;\n   const indexOfFirstPost = indexOfLastPosts - postsPerPage;\n   const paginate = pageNumber => setcurrentPage(pageNumber);\n\n  useEffect(()=>{\n    const updatePosts=()=>{\n    setcurrentPosts(LoadedTheatres.slice(indexOfFirstPost,indexOfLastPosts))};\n    updatePosts()},[LoadedTheatres,currentPage,PaginationPage]);\n\n  const errorHandler = () =>{\n    setError=(null);\n  }\n   \n  \n\n  return(       \n    <React.Fragment>\n    <PaginationPage postsPerPage={postsPerPage} totalPosts={LoadedTheatres.length} paginate={paginate}/>\n    {isLoading && (<div><LoadingSpinner /></div>)}\n    {!isLoading && LoadedTheatres && <PlaceList items={currentPosts} />}\n     </React.Fragment>)\n  };\n\nexport default UserPlaces;\n"]},"metadata":{},"sourceType":"module"}