{"ast":null,"code":"import _regeneratorRuntime from\"/Users/liwentian/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/liwentian/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/liwentian/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _readOnlyError from\"/Users/liwentian/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/readOnlyError\";import React,{useEffect,useState}from'react';import MovieList from'../components/MovieList';import{useHttpClient}from'../../shared/hooks/http-hook';import LoadingSpinner from'../../shared/components/UIElements/LoadingSpinner';import PaginationPage from'../../shared/components/UIElements/pagination';var Movies=function Movies(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),LoadedMovies=_useState2[0],setLoadedMovies=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setisLoading=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),currentPage=_useState8[0],setcurrentPage=_useState8[1];var postsPerPage=20;var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),currentPosts=_useState10[0],setcurrentPosts=_useState10[1];useEffect(function(){var fetchMovies=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,responseData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setisLoading(true);_context.prev=1;_context.next=4;return fetch(process.env.REACT_APP_BACKEND_URL+\"/movies\");case 4:response=_context.sent;_context.next=7;return response.json();case 7:responseData=_context.sent;if(response.ok){_context.next=10;break;}throw new Error(responseData.message);case 10:setLoadedMovies(responseData.movies);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);setError(_context.t0.message);case 16:setisLoading(false);case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,13]]);}));return function fetchMovies(){return _ref.apply(this,arguments);};}();fetchMovies();},[]);var indexOfLastPosts=currentPage*postsPerPage;var indexOfFirstPost=indexOfLastPosts-postsPerPage;var paginate=function paginate(pageNumber){return setcurrentPage(pageNumber);};useEffect(function(){var updatePosts=function updatePosts(){setcurrentPosts(LoadedMovies.slice(indexOfFirstPost,indexOfLastPosts));};updatePosts();},[LoadedMovies,currentPage,PaginationPage]);var errorHandler=function errorHandler(){setError=(_readOnlyError(\"setError\"),null);};return React.createElement(React.Fragment,null,React.createElement(PaginationPage,{postsPerPage:postsPerPage,totalPosts:LoadedMovies.length,paginate:paginate}),isLoading&&React.createElement(\"div\",null,React.createElement(LoadingSpinner,null)),!isLoading&&LoadedMovies&&React.createElement(MovieList,{items:currentPosts}));};export default Movies;","map":{"version":3,"sources":["/Users/liwentian/Desktop/frontend/src/movies/pages/Movies.js"],"names":["React","useEffect","useState","MovieList","useHttpClient","LoadingSpinner","PaginationPage","Movies","LoadedMovies","setLoadedMovies","isLoading","setisLoading","error","setError","currentPage","setcurrentPage","postsPerPage","currentPosts","setcurrentPosts","fetchMovies","fetch","process","env","REACT_APP_BACKEND_URL","response","json","responseData","ok","Error","message","movies","indexOfLastPosts","indexOfFirstPost","paginate","pageNumber","updatePosts","slice","errorHandler","length"],"mappings":"6lBACA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA0BC,QAA1B,KAA0C,OAA1C,CACA,MAAOC,CAAAA,SAAP,KAAsB,yBAAtB,CACA,OAASC,aAAT,KAA8B,8BAA9B,CACA,MAAOC,CAAAA,cAAP,KAA2B,mDAA3B,CACA,MAAOC,CAAAA,cAAP,KAA2B,+CAA3B,CACA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,eACmBL,QAAQ,CAAC,EAAD,CAD3B,wCACbM,YADa,eACAC,eADA,8BAEaP,QAAQ,CAAC,KAAD,CAFrB,yCAEbQ,SAFa,eAEHC,YAFG,8BAGKT,QAAQ,EAHb,yCAGbU,KAHa,eAGPC,QAHO,8BAIiBX,QAAQ,CAAC,CAAD,CAJzB,yCAIbY,WAJa,eAIDC,cAJC,eAKnB,GAAMC,CAAAA,YAAY,CAAG,EAArB,CALmB,eAMoBd,QAAQ,CAAC,EAAD,CAN5B,0CAMZe,YANY,gBAMCC,eAND,gBAQnBjB,SAAS,CAAC,UAAI,CAEZ,GAAMkB,CAAAA,WAAW,0FAAG,6JAClBR,YAAY,CAAC,IAAD,CAAZ,CADkB,sCAGMS,CAAAA,KAAK,CAACC,OAAO,CAACC,GAAR,CAAYC,qBAAZ,UAAD,CAHX,QAGVC,QAHU,qCAIWA,CAAAA,QAAQ,CAACC,IAAT,EAJX,QAIVC,YAJU,kBAKZF,QAAQ,CAACG,EALG,+BAOR,IAAIC,CAAAA,KAAJ,CAAUF,YAAY,CAACG,OAAvB,CAPQ,SAShBpB,eAAe,CAACiB,YAAY,CAACI,MAAd,CAAf,CATgB,iFAWhBjB,QAAQ,CAAC,YAAIgB,OAAL,CAAR,CAXgB,QAalBlB,YAAY,CAAC,KAAD,CAAZ,CAbkB,qEAAH,kBAAXQ,CAAAA,WAAW,0CAAjB,CAgBAA,WAAW,GACZ,CAnBQ,CAmBP,EAnBO,CAAT,CAqBA,GAAMY,CAAAA,gBAAgB,CAAGjB,WAAW,CAAGE,YAAvC,CACC,GAAMgB,CAAAA,gBAAgB,CAAGD,gBAAgB,CAAGf,YAA5C,CACA,GAAMiB,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAAC,UAAU,QAAInB,CAAAA,cAAc,CAACmB,UAAD,CAAlB,EAA3B,CAEDjC,SAAS,CAAC,UAAI,CACZ,GAAMkC,CAAAA,WAAW,CAAC,QAAZA,CAAAA,WAAY,EAAI,CACtBjB,eAAe,CAACV,YAAY,CAAC4B,KAAb,CAAmBJ,gBAAnB,CAAoCD,gBAApC,CAAD,CAAf,CAAuE,CADvE,CAEAI,WAAW,GAAG,CAHP,CAGQ,CAAC3B,YAAD,CAAcM,WAAd,CAA0BR,cAA1B,CAHR,CAAT,CAKA,GAAM+B,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAK,CACxBxB,QAAQ,6BAAE,IAAF,CAAR,CACD,CAFD,CAOA,MACE,qBAAC,KAAD,CAAO,QAAP,MACA,oBAAC,cAAD,EAAgB,YAAY,CAAEG,YAA9B,CAA4C,UAAU,CAAER,YAAY,CAAC8B,MAArE,CAA6E,QAAQ,CAAEL,QAAvF,EADA,CAECvB,SAAS,EAAK,+BAAK,oBAAC,cAAD,MAAL,CAFf,CAGC,CAACA,SAAD,EAAcF,YAAd,EAA4B,oBAAC,SAAD,EAAW,KAAK,CAAES,YAAlB,EAH7B,CADF,CAMC,CAnDH,CAqDA,cAAeV,CAAAA,MAAf","sourcesContent":["\nimport React, { useEffect,useState } from 'react';\nimport MovieList from '../components/MovieList';\nimport { useHttpClient } from '../../shared/hooks/http-hook';\nimport LoadingSpinner from '../../shared/components/UIElements/LoadingSpinner';\nimport PaginationPage from '../../shared/components/UIElements/pagination';\nconst Movies = () => {\n  const[LoadedMovies,setLoadedMovies] = useState([]);\n  const[isLoading,setisLoading] = useState(false);\n  const[error,setError] = useState();\n  const[currentPage,setcurrentPage] = useState(1);\n  const postsPerPage = 20;\n  const [currentPosts,setcurrentPosts] = useState([]);\n\n  useEffect(()=>{\n\n    const fetchMovies = async()=>{\n      setisLoading(true);\n      try{          \n        const response= await fetch(process.env.REACT_APP_BACKEND_URL+`/movies`); \n        const responseData = await response.json();\n        if(!response.ok){\n    \n          throw new Error(responseData.message);\n        }\n        setLoadedMovies(responseData.movies);\n      } catch (err) {\n        setError(err.message);\n      }\n      setisLoading(false);\n    };\n\n    fetchMovies();\n  },[]);\n\n  const indexOfLastPosts = currentPage * postsPerPage;\n   const indexOfFirstPost = indexOfLastPosts - postsPerPage;\n   const paginate = pageNumber => setcurrentPage(pageNumber);\n\n  useEffect(()=>{\n    const updatePosts=()=>{\n    setcurrentPosts(LoadedMovies.slice(indexOfFirstPost,indexOfLastPosts))};\n    updatePosts()},[LoadedMovies,currentPage,PaginationPage]);\n\n  const errorHandler = () =>{\n    setError=(null);\n  }\n   \n  \n\n\n  return(       \n    <React.Fragment>\n    <PaginationPage postsPerPage={postsPerPage} totalPosts={LoadedMovies.length} paginate={paginate}/>\n    {isLoading && (<div><LoadingSpinner /></div>)}\n    {!isLoading && LoadedMovies&&<MovieList items={currentPosts}/>} \n    </React.Fragment>)\n  };\n\nexport default Movies;\n\n\n\n          \n\n\n\n"]},"metadata":{},"sourceType":"module"}